# 小程序设计

因为小程序页面无法直接渲染markdown语法，因此使用了towxml，可以将markdown文件的内容自动转化为小程序页面的

因为课程内容尚未公开，因此仅展示部分截图

## 开发经历

小程序的设计本质上和网页的开发很像，尤其是跟现在流行的react或者vue开发都很相似，因此熟悉了结构和整个页面的生命周期之后上手并不难。

本项目的任务是要把老师的ppt转换为小程序的页面。但因为考虑到手动开发把ppt的内容直接转化为小程序的页面是一件工程量很大的事，因为既要考虑内容还要考虑页面内的排版所以想先把ppt转写为markdown文件，然后再转换成小程序的页面。理由是markdown作为今年来非常流行的写文档的工具，可以让开发者不用太在意排版进行写作，这样虽然课程内容仍旧非常多，但是可以减轻不少工作量。

但是开发过程中我遇到了以下的问题：

- 微信小程序无法直接将markdown文件渲染到页面上
- 直接生成的文件太多，项目大小容易超过限制
- 老师在ppt的图片上作了标注
- 老师在ppt中绘制了很多自定义的图形而在markdown中很难实现

因此我查阅了很多资料想了很多办法，最终这些办法都已解决。

### 无法直接渲染markdown

我在网上找到了towxml,一个很好用的插件，可以直接将markdown转换成wxml，也就是小程序的页面，这个插件定义了一个模板，将markdown的语法转化成wxml的标签，如# xxxx 会被转换成 <h1>xxx<h1>,但是这个插件仍在开发中，偶尔会出现bug，不如字体加粗有时会无法识别，如__,但是整体功能强大，完美满足了需求。
  
### 项目太大问题

原本我想把每一个ppt写成一个文件，而且在markdown中插入图片是如果使用相对路径的话就意味着要把所有的图片一起发布，但是那样会导致生成的文件太多，让文件结构非常臃肿，会拖慢程序的响应速度，这绝不是好的设计，因为用户每次都会请求所有的内容。因此我试着把所有的资源都保存在云端，包括markdown文件本身和其中用到的图片，因为保存在小程序云端的资源都会有一个url，所以markdown通过url请求图片，而查看课程内容时每次都会根据url请求相应的文件，直接将请求到的数据转化成页面。

### 图片标注和自定义的图形

一开始我对问题很是头疼，因为从ppt中保存的图片是不会保留老师的痕迹的，自定义的图形也实在难画，因此我采取了一个很简单的办法：截图，尽管有的时候不可避免的会截到ppt页面的边框导致图片看上去不是很美观，但是仍然满足了需求。

